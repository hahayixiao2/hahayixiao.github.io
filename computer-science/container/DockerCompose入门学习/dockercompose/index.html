



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="一个小萌新的进阶之路" href="https://hahayixiao2.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="一个小萌新的进阶之路" href="https://hahayixiao2.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="一个小萌新的进阶之路" href="https://hahayixiao2.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="Docker" />


<link rel="canonical" href="https://hahayixiao2.github.io/computer-science/container/DockerCompose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/dockercompose/">



  <title>
dockercompose笔记 - 容器 - 计算机 |
HaHaYiXiao = 一个小萌新的进阶之路</title>
<meta name="generator" content="Hexo 6.1.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">dockercompose笔记
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2022-05-02 20:56:48">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2022-05-02T20:56:48+08:00">2022-05-02</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">HaHaYiXiao</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclflwv2aj20zk0m84qp.jpg"></li>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclgrvbd6j20zk0m8qv5.jpg"></li>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipewkhf1zj20zk0m81kx.jpg"></li>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipevo9j1jj20zk0m8e81.jpg"></li>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giciusoyjnj219g0u0x56.jpg"></li>
          <li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giciukx8a7j20zk0m8aio.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="分类于 计算机"><span itemprop="name">计算机</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/container/" itemprop="item" rel="index" title="分类于 容器"><span itemprop="name">容器</span></a>
<meta itemprop="position" content="2" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://hahayixiao2.github.io/computer-science/container/DockerCompose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/dockercompose/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/avatar.png">
    <meta itemprop="name" content="hahayixiao">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="一个小萌新的进阶之路">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="docker-compose入门学习"><a class="markdownIt-Anchor" href="#docker-compose入门学习">#</a> Docker Compose 入门学习</h1>
<h2 id="简介"><a class="markdownIt-Anchor" href="#简介">#</a> 简介</h2>
<p>我们之前操作 Docker 的过程是：DockerFile  build run 进行手动操作，单个容器，如果假设我们有 100 个微服务，并行微服务之间还存在依赖关系。这个时候，我们就可以使用 Docker Compose 来轻松高效的管理容器，定义运行多个容器。</p>
<h3 id="官方介绍"><a class="markdownIt-Anchor" href="#官方介绍">#</a> 官方介绍：</h3>
<ul>
<li>定义、运行多个容器</li>
<li>YAML file 配置环境</li>
</ul>
<blockquote>
<p>Compose 是一个用于定义和运行多容器 Docker 应用程序的工具。使用 Compose，您可以使用 YAML 文件来配置应用程序的服务。然后，使用一个命令，就可以从配置中创建并启动所有服务。要了解有关 Compose 的所有特性的更多信息，请参阅<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS8jZmVhdHVyZXM=">特性列表</span>。</p>
<p>Compose 可以在所有环境中工作：生产、阶段、开发、测试，以及 CI 工作流。您可以在常见用例中了解关于每个用例的更多信息</p>
<p>使用 Compose 基本上有三个步骤:</p>
<ul>
<li>用 Dockerfile 定义你的应用程序的环境，这样它就可以在任何地方复制。</li>
<li>在 Docker-compose 中定义组成应用程序的服务。这样它们就可以在一个独立的环境中一起运行。</li>
<li>运行 docker-compose up 和 Compose 启动并运行整个应用程序。</li>
</ul>
</blockquote>
<h3 id="作用"><a class="markdownIt-Anchor" href="#作用">#</a> 作用</h3>
<p>批量容器编排</p>
<blockquote>
<p>Compose 是 Docker 官方的开源项目，需要安装！</p>
<p>Dockerfile 让程序在任何地方运行，web 服务。Redis、MySQL、Nginx。。。多个容器</p>
</blockquote>
<p>Compose 的 YAML 文件如下所示</p>
<figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2.0'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">web</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token key atrule">build</span><span class="token punctuation">:</span> .</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token key atrule">ports</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">-</span> <span class="token string">"5000:5000"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">-</span> .<span class="token punctuation">:</span>/code</pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">-</span> logvolume01<span class="token punctuation">:</span>/var/log</pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token key atrule">links</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">-</span> redis</pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token key atrule">redis</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token key atrule">logvolume01</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>docker-compose up 100 个服务，也可以一键启动</p>
<p>Compose：重要的概念</p>
<ul>
<li>服务 service，容器，应用（web，redis，mysql）</li>
<li>项目 project，就是一组关联的容器。</li>
</ul>
<h2 id="常见的docker-compose脚本"><a class="markdownIt-Anchor" href="#常见的docker-compose脚本">#</a> 常见的 Docker Compose 脚本</h2>
<p>下面这个是小伙伴开源的一些 Docker Compose 脚本，我们如果需要部署某个应用的时候，可以通过下面脚本，非常方便的进行部署</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vemhlbmdxaW5neWEvZG9ja2VyLWNvbXBvc2U=">https://gitee.com/zhengqingya/docker-compose</span></p>
<h2 id="安装docker-compose"><a class="markdownIt-Anchor" href="#安装docker-compose">#</a> 安装 Docker Compose</h2>
<p>官方文档：<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9pbnN0YWxsLw==">https://docs.docker.com/compose/install/</span></p>
<h3 id="下载"><a class="markdownIt-Anchor" href="#下载">#</a> 下载</h3>
<p>首先我们先安装一下 Docker</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># yum 安装</span></pre></td></tr><tr><td data-num="2"></td><td><pre>yum -y <span class="token function">install</span> docker-ce</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#查看 docker 版本</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">docker</span> --version  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 设置开机自启</span></pre></td></tr><tr><td data-num="6"></td><td><pre>systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 启动 docker</span></pre></td></tr><tr><td data-num="8"></td><td><pre>systemctl start <span class="token function">docker</span></pre></td></tr></table></figure><p>然后下载 docker-compose</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">curl</span> -L <span class="token string">"https://github.com/docker/compose/releases/download/1.26.2/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -s<span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -m<span class="token variable">)</span></span>"</span> -o /usr/local/bin/docker-compose</pre></td></tr></table></figure><h3 id="授权"><a class="markdownIt-Anchor" href="#授权">#</a> 授权</h3>
<p>下载完成后，我们进入到下面的目录</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> /usr/local/bin</pre></td></tr></table></figure><p>然后加入执行权限</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">chmod</span> +x <span class="token function">docker-compose</span></pre></td></tr></table></figure><p>查看是否安装成功</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker-compose</span> version</pre></td></tr></table></figure><h3 id="创建文件体验"><a class="markdownIt-Anchor" href="#创建文件体验">#</a> 创建文件体验</h3>
<p>在这个页面中，您将构建一个运行在 Docker 撰写器上的简单 Python web 应用程序。该应用程序使用了烧瓶框架，并在 Redis 中维护了一个命中计数器。虽然示例使用 Python，但是即使您不熟悉它，这里演示的概念也应该可以理解。</p>
<p>确保你已经安装了 Docker 引擎和 Docker 组合。你不需要安装 Python 或 Redis，因为它们都是由 Docker images 提供的。</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 创建文件夹</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">mkdir</span> composetest</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 进入该文件夹</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">cd</span> composetest</pre></td></tr></table></figure><p>然后我们需要创建一个 <span class="exturl" data-url="aHR0cDovL2FwcC5weQ==">app.py</span> 文件</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">import</span> <span class="token function">time</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">import</span> redis</pre></td></tr><tr><td data-num="4"></td><td><pre>from flask <span class="token function">import</span> Flask</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>cache <span class="token operator">=</span> redis.Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'redis'</span>, <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>def get_hit_count<span class="token punctuation">(</span><span class="token punctuation">)</span>:</pre></td></tr><tr><td data-num="11"></td><td><pre>    retries <span class="token operator">=</span> <span class="token number">5</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">while</span> True:</pre></td></tr><tr><td data-num="13"></td><td><pre>        try:</pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token builtin class-name">return</span> cache.incr<span class="token punctuation">(</span><span class="token string">'hits'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        except redis.exceptions.ConnectionError as exc:</pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">if</span> retries <span class="token operator">==</span> <span class="token number">0</span>:</pre></td></tr><tr><td data-num="17"></td><td><pre>                raise exc</pre></td></tr><tr><td data-num="18"></td><td><pre>            retries -<span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            time.sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>@app.route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>def hello<span class="token punctuation">(</span><span class="token punctuation">)</span>:</pre></td></tr><tr><td data-num="24"></td><td><pre>    count <span class="token operator">=</span> get_hit_count<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token builtin class-name">return</span> <span class="token string">'Hello World! I have been seen &#123;&#125; times.\n'</span>.format<span class="token punctuation">(</span>count<span class="token punctuation">)</span></pre></td></tr></table></figure><p>然后创建一个 requirements.txt 文件，里面需要依赖包</p>
<figure class="highlight py"><figcaption data-lang="Python"></figcaption><table><tr><td data-num="1"></td><td><pre>flask</pre></td></tr><tr><td data-num="2"></td><td><pre>redis</pre></td></tr></table></figure><h3 id="创建docker-file"><a class="markdownIt-Anchor" href="#创建docker-file">#</a> 创建 Docker file</h3>
<p>在这个步骤中，您将编写一个构建 Docker 映像的 Dockerfile。该映像包含 Python 应用程序需要的所有依赖项，包括 Python 本身。在您的项目目录中，创建一个名为 Dockerfile 的文件，并粘贴以下内容:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>FROM python:3.7-alpine</pre></td></tr><tr><td data-num="2"></td><td><pre>WORKDIR /code</pre></td></tr><tr><td data-num="3"></td><td><pre>ENV FLASK_APP app.py</pre></td></tr><tr><td data-num="4"></td><td><pre>ENV FLASK_RUN_HOST <span class="token number">0.0</span>.0.0</pre></td></tr><tr><td data-num="5"></td><td><pre>RUN apk <span class="token function">add</span> --no-cache gcc musl-dev linux-headers</pre></td></tr><tr><td data-num="6"></td><td><pre>COPY requirements.txt requirements.txt</pre></td></tr><tr><td data-num="7"></td><td><pre>RUN pip <span class="token function">install</span> -r requirements.txt</pre></td></tr><tr><td data-num="8"></td><td><pre>EXPOSE <span class="token number">5000</span></pre></td></tr><tr><td data-num="9"></td><td><pre>COPY <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span></pre></td></tr><tr><td data-num="10"></td><td><pre>CMD <span class="token punctuation">[</span><span class="token string">"flask"</span>, <span class="token string">"run"</span><span class="token punctuation">]</span></pre></td></tr></table></figure><blockquote>
<p>上述代码中，是为了告诉 Docker</p>
<p>从 Python3.7 版本开始构建镜像</p>
<p>将当前目录设置为 /code</p>
<p>安装 python 依赖项</p>
<p>将容器的默认命令设置为 python <span class="exturl" data-url="aHR0cDovL2FwcC5weQ==">app.py</span></p>
</blockquote>
<h3 id="定义服务在compose文件中"><a class="markdownIt-Anchor" href="#定义服务在compose文件中">#</a> 定义服务在 Compose 文件中</h3>
<p>创建一个名为 docker-compose 的文件。yml 在您的项目目录，并粘贴以下</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>version: <span class="token string">'3'</span></pre></td></tr><tr><td data-num="2"></td><td><pre>services:</pre></td></tr><tr><td data-num="3"></td><td><pre>  web:</pre></td></tr><tr><td data-num="4"></td><td><pre>    build: <span class="token builtin class-name">.</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ports:</pre></td></tr><tr><td data-num="6"></td><td><pre>      - <span class="token string">"5000:5000"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  redis:</pre></td></tr><tr><td data-num="8"></td><td><pre>    image: <span class="token string">"redis:alpine"</span></pre></td></tr></table></figure><blockquote>
<p>此 Compose 文件定义了两个服务，web 和 redis，该 web 服务使用从 Docker file 当前目录中构建的镜像</p>
<p>将容器上的公开端口 5000</p>
</blockquote>
<p>这个合成文件定义了两个服务:web 和 redis。</p>
<h4 id="web服务"><a class="markdownIt-Anchor" href="#web服务">#</a> Web 服务</h4>
<p>web 服务使用从当前目录中的 Dockerfile 构建的映像。然后，它将容器和主机绑定到公开的端口 5000。这个示例服务使用了 Flask web 服务器 5000 的默认端口</p>
<h4 id="redis服务"><a class="markdownIt-Anchor" href="#redis服务">#</a> Redis 服务</h4>
<p>redis 服务使用从 Docker Hub 注册中心提取的公共 redis 图像</p>
<h3 id="使用compose构建和运行应用程序"><a class="markdownIt-Anchor" href="#使用compose构建和运行应用程序">#</a> 使用 Compose 构建和运行应用程序</h3>
<p>在项目目录中，通过运行启动应用程序   <code>docker-compose up</code> .</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker-compose</span> up</pre></td></tr></table></figure><p>运行结果如下</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>Creating network <span class="token string">"composetest_default"</span> with the default driver</pre></td></tr><tr><td data-num="2"></td><td><pre>Creating composetest_web_1 <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>Creating composetest_redis_1 <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="4"></td><td><pre>Creating composetest_web_1</pre></td></tr><tr><td data-num="5"></td><td><pre>Creating composetest_redis_1 <span class="token punctuation">..</span>. <span class="token keyword">done</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Attaching to composetest_web_1, composetest_redis_1</pre></td></tr><tr><td data-num="7"></td><td><pre>web_1    <span class="token operator">|</span>  * Running on http://0.0.0.0:5000/ <span class="token punctuation">(</span>Press CTRL+C to quit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:C <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.480 <span class="token comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></pre></td></tr><tr><td data-num="9"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:C <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.480 <span class="token comment"># Redis version=4.0.1, bits=64, commit=00000000, modified=0, pid=1, just started</span></pre></td></tr><tr><td data-num="10"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:C <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.480 <span class="token comment"># Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf</span></pre></td></tr><tr><td data-num="11"></td><td><pre>web_1    <span class="token operator">|</span>  * Restarting with <span class="token function">stat</span></pre></td></tr><tr><td data-num="12"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.483 * Running <span class="token assign-left variable">mode</span><span class="token operator">=</span>standalone, <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">6379</span>.</pre></td></tr><tr><td data-num="13"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.483 <span class="token comment"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span></pre></td></tr><tr><td data-num="14"></td><td><pre>web_1    <span class="token operator">|</span>  * Debugger is active<span class="token operator">!</span></pre></td></tr><tr><td data-num="15"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.483 <span class="token comment"># Server initialized</span></pre></td></tr><tr><td data-num="16"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.483 <span class="token comment"># WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</span></pre></td></tr><tr><td data-num="17"></td><td><pre>web_1    <span class="token operator">|</span>  * Debugger PIN: <span class="token number">330</span>-787-903</pre></td></tr><tr><td data-num="18"></td><td><pre>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">17</span> Aug <span class="token number">22</span>:11:10.483 * Ready to accept connections</pre></td></tr></table></figure><p>最后查看服务是否启动成功</p>
<p><img data-src="images/image-20200727212451516.png" alt="image-20200727212451516"></p>
<p>使用 docker images 命令，我们发现在 docker compose 中的镜像都已经下载好了</p>
<p><img data-src="images/image-20200727212555232.png" alt="image-20200727212555232"></p>
<h3 id="网络规则"><a class="markdownIt-Anchor" href="#网络规则">#</a> 网络规则</h3>
<p>使用下面的命令，就可以查看到 docker 中的网络</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> network <span class="token function">ls</span></pre></td></tr></table></figure><p><img data-src="images/image-20200727212932704.png" alt="image-20200727212932704"></p>
<p>通过 compose 构建的服务，compose 帮我们维护了，都会在一个网络下面，就可以通过域名访问</p>
<p>我们通过以下命令来进行查看，发现启动的两个服务，就是同处于同一个网络下的</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> network inspect composetest_default</pre></td></tr></table></figure><p><img data-src="images/image-20200727213527466.png" alt="image-20200727213527466"></p>
<h3 id="关闭docker-compose"><a class="markdownIt-Anchor" href="#关闭docker-compose">#</a> 关闭 docker compose</h3>
<p>可以使用一下命令退出</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker-compose</span> down</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 或者</span></pre></td></tr><tr><td data-num="3"></td><td><pre>ctrl + c</pre></td></tr></table></figure><h3 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h3>
<p>我们可以对上述的操作，进行一下总结，就可以分为一下几个步骤</p>
<ul>
<li>应用 <span class="exturl" data-url="aHR0cDovL2FwcC5weQ==">app.py</span></li>
<li>Docker file  将应用程序打包成镜像</li>
<li>Docker-compose yaml 文件（定义整个服务，需要的环境，web、redis）完整的上线服务</li>
<li>启动 compose 项目（docker-compose up）</li>
<li>流程
<ul>
<li>创建网络</li>
<li>执行 Docker-compose yaml</li>
<li>启动服务</li>
</ul>
</li>
</ul>
<p>原来我们没有用到 docker-compose 的时候，都是需要使用 docker run，一个个的运行我们的容器</p>
<p>通过 docker-compose，我们编写 yaml 文件，可以通过 docker-compose 一键启动服务，或者停止。</p>
<h2 id="yaml规则"><a class="markdownIt-Anchor" href="#yaml规则">#</a> yaml 规则</h2>
<p>docker-compose.yaml 规则</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 三层</span></pre></td></tr><tr><td data-num="2"></td><td><pre>version: <span class="token string">"3.8"</span>  <span class="token comment"># 定义版本</span></pre></td></tr><tr><td data-num="3"></td><td><pre>services:       <span class="token comment"># 定义服务</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   服务1:web</pre></td></tr><tr><td data-num="5"></td><td><pre>       images</pre></td></tr><tr><td data-num="6"></td><td><pre>       build</pre></td></tr><tr><td data-num="7"></td><td><pre>       network</pre></td></tr><tr><td data-num="8"></td><td><pre>	   <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span></pre></td></tr><tr><td data-num="9"></td><td><pre>   服务2:redis</pre></td></tr><tr><td data-num="10"></td><td><pre>   		<span class="token punctuation">..</span><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="11"></td><td><pre>   服务3:nginx</pre></td></tr><tr><td data-num="12"></td><td><pre>   		<span class="token punctuation">..</span><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token comment"># 其它配置 网络 / 卷、全局规则</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  volumes:</pre></td></tr><tr><td data-num="15"></td><td><pre>  networks:</pre></td></tr><tr><td data-num="16"></td><td><pre>  configs:</pre></td></tr></table></figure><p>完整实例如下</p>
<figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">redis</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>latest</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token key atrule">deploy</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token key atrule">configs</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">-</span> my_config</pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token punctuation">-</span> my_other_config</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token key atrule">configs</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token key atrule">my_config</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token key atrule">file</span><span class="token punctuation">:</span> ./my_config.txt</pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token key atrule">my_other_config</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token key atrule">external</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></td></tr></table></figure><h3 id="依赖关系"><a class="markdownIt-Anchor" href="#依赖关系">#</a> 依赖关系</h3>
<p>如果我们的项目还有依赖关系，比如  web 依赖于 redis，也就是说项目需要首先启动 redis</p>
<figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">web</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token key atrule">build</span><span class="token punctuation">:</span> .</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token punctuation">-</span> db</pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token punctuation">-</span> redis</pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token key atrule">redis</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis</pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token key atrule">db</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres</pre></td></tr></table></figure><h2 id="快速搭建wordpress"><a class="markdownIt-Anchor" href="#快速搭建wordpress">#</a> 快速搭建 WordPress</h2>
<p>官网搭建文档：<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS93b3JkcHJlc3Mv">https://docs.docker.com/compose/wordpress/</span></p>
<p>首先创建项目的文件夹</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 创建文件夹</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">mkdir</span> my_wordpress</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 进入文件夹</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">cd</span> my_wordpress/</pre></td></tr></table></figure><p>然后创建一个 docker-compose.yml 文件</p>
<figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span> <span class="token comment"># 定义版本</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token key atrule">services</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token key atrule">db</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>     <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">5.7</span></pre></td></tr><tr><td data-num="6"></td><td><pre>     <span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>       <span class="token punctuation">-</span> db_data<span class="token punctuation">:</span>/var/lib/mysql</pre></td></tr><tr><td data-num="8"></td><td><pre>     <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</pre></td></tr><tr><td data-num="9"></td><td><pre>     <span class="token key atrule">environment</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>       <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> somewordpress</pre></td></tr><tr><td data-num="11"></td><td><pre>       <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="12"></td><td><pre>       <span class="token key atrule">MYSQL_USER</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="13"></td><td><pre>       <span class="token key atrule">MYSQL_PASSWORD</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>   <span class="token key atrule">wordpress</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>     <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>  <span class="token comment"># 依赖于上一个 db，也就是需要 db 启动</span></pre></td></tr><tr><td data-num="17"></td><td><pre>       <span class="token punctuation">-</span> db</pre></td></tr><tr><td data-num="18"></td><td><pre>     <span class="token key atrule">image</span><span class="token punctuation">:</span> wordpress<span class="token punctuation">:</span>latest</pre></td></tr><tr><td data-num="19"></td><td><pre>     <span class="token key atrule">ports</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>       <span class="token punctuation">-</span> <span class="token string">"8000:80"</span></pre></td></tr><tr><td data-num="21"></td><td><pre>     <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</pre></td></tr><tr><td data-num="22"></td><td><pre>     <span class="token key atrule">environment</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>       <span class="token key atrule">WORDPRESS_DB_HOST</span><span class="token punctuation">:</span> db<span class="token punctuation">:</span><span class="token number">3306</span></pre></td></tr><tr><td data-num="24"></td><td><pre>       <span class="token key atrule">WORDPRESS_DB_USER</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="25"></td><td><pre>       <span class="token key atrule">WORDPRESS_DB_PASSWORD</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="26"></td><td><pre>       <span class="token key atrule">WORDPRESS_DB_NAME</span><span class="token punctuation">:</span> wordpress</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token key atrule">volumes</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token key atrule">db_data</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>后台启动项目</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker-compose</span>  -d</pre></td></tr></table></figure><p>到此为止，项目已经成功搭建完毕</p>
<blockquote>
<p>正常的开源项目，可能还需要依赖 build 后的 jar 包，所以我们还需要使用 Dockerfile</p>
<p>当我们的文件准备齐全的时候，就可以一键启动项目</p>
</blockquote>
<p>未来的趋势：linux、docker、k8s</p>
<p>掌握：docker 基础、原理、网络、服务、集群、错误排查、日志。</p>
<h2 id="docker-compose搭建微服务"><a class="markdownIt-Anchor" href="#docker-compose搭建微服务">#</a> docker-compose 搭建微服务</h2>
<p>我们可以使用下面命令 ，创建一个 SpringBoot 项目：<span class="exturl" data-url="aHR0cHM6Ly9zdGFydC5zcHJpbmcuaW8v">https://start.spring.io/</span></p>
<ul>
<li>编写项目微服务</li>
<li>dockerfile 构建镜像</li>
<li>创建 docker-compose 来启动项目，进行服务编排</li>
<li>丢到服务器 docker-compose 启动</li>
<li>如果出现了问题：使用 docker-compose up  --build（重新构建）</li>
</ul>
<h2 id="docker小结"><a class="markdownIt-Anchor" href="#docker小结">#</a> Docker 小结</h2>
<ul>
<li>Docker 镜像 -&gt; 通过 run 命令启动镜像</li>
<li>Dockerfile 构建镜像（服务打包）</li>
<li>docker-compose 启动项目（编排、多个微服务 / 环境）</li>
<li>Docker 网络</li>
</ul>
<h2 id="参考"><a class="markdownIt-Anchor" href="#参考">#</a> 参考</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWt2NDExcTdRYw==">https://www.bilibili.com/video/BV1kv411q7Qc</span></p>

      <div class="tags">
          <a href="/tags/Docker/" rel="tag"><i class="ic i-tag"></i> Docker</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2022-05-02 22:34:09" itemprop="dateModified" datetime="2022-05-02T22:34:09+08:00">2022-05-02</time>
  </span>
  <span id="computer-science/container/DockerCompose入门学习/dockercompose/" class="item leancloud_visitors" data-flag-title="dockercompose笔记" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/wechatpay.png" alt="hahayixiao 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/alipay.png" alt="hahayixiao 支付宝">
        <p>支付宝</p>
      </div>
      
      <div>
        <img data-src="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/paypal.png" alt="hahayixiao 贝宝">
        <p>贝宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>hahayixiao <i class="ic i-at"><em>@</em></i>一个小萌新的进阶之路
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://hahayixiao2.github.io/computer-science/container/DockerCompose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/dockercompose/" title="dockercompose笔记">https://hahayixiao2.github.io/computer-science/container/DockerCompose入门学习/dockercompose/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/computer-science/note/theme-shoka-doc/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicivghyooj20zk0m8dir.jpg" title="Hexo主题Shoka &amp; multi-markdown-it渲染器使用说明">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> Theme Shoka Documentation</span>
  <h3>Hexo主题Shoka & multi-markdown-it渲染器使用说明</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/computer-science/container/Docker/docker/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclx6phq6j20zk0m8e36.jpg" title="docker笔记">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 容器</span>
  <h3>docker笔记</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-compose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.</span> <span class="toc-text"> Docker Compose 入门学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text"> 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 官方介绍：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84docker-compose%E8%84%9A%E6%9C%AC"><span class="toc-number">1.2.</span> <span class="toc-text"> 常见的 Docker Compose 脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker-compose"><span class="toc-number">1.3.</span> <span class="toc-text"> 安装 Docker Compose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%88%E6%9D%83"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 授权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E4%BD%93%E9%AA%8C"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 创建文件体验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAdocker-file"><span class="toc-number">1.3.4.</span> <span class="toc-text"> 创建 Docker file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1%E5%9C%A8compose%E6%96%87%E4%BB%B6%E4%B8%AD"><span class="toc-number">1.3.5.</span> <span class="toc-text"> 定义服务在 Compose 文件中</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#web%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.5.1.</span> <span class="toc-text"> Web 服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redis%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.5.2.</span> <span class="toc-text"> Redis 服务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8compose%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.3.6.</span> <span class="toc-text"> 使用 Compose 构建和运行应用程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%A7%84%E5%88%99"><span class="toc-number">1.3.7.</span> <span class="toc-text"> 网络规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%97%ADdocker-compose"><span class="toc-number">1.3.8.</span> <span class="toc-text"> 关闭 docker compose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.9.</span> <span class="toc-text"> 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml%E8%A7%84%E5%88%99"><span class="toc-number">1.4.</span> <span class="toc-text"> yaml 规则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 依赖关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BAwordpress"><span class="toc-number">1.5.</span> <span class="toc-text"> 快速搭建 WordPress</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose%E6%90%AD%E5%BB%BA%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.6.</span> <span class="toc-text"> docker-compose 搭建微服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%B0%8F%E7%BB%93"><span class="toc-number">1.7.</span> <span class="toc-text"> Docker 小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.8.</span> <span class="toc-text"> 参考</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/computer-science/container/Docker/docker/" rel="bookmark" title="docker笔记">docker笔记</a></li><li class="active"><a href="/computer-science/container/DockerCompose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/dockercompose/" rel="bookmark" title="dockercompose笔记">dockercompose笔记</a></li><li><a href="/computer-science/container/DockerDesktop%E5%85%A5%E9%97%A8%E7%AE%80%E4%BB%8B/dockerdesktop/" rel="bookmark" title="dockercompose笔记">dockercompose笔记</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="hahayixiao"
      data-src="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/images/avatar.png">
  <p class="name" itemprop="name">hahayixiao</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">10</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">5</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhaGF5aXhpYW8y" title="https:&#x2F;&#x2F;github.com&#x2F;hahayixiao2"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/computer-science/note/theme-shoka-doc/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/computer-science/container/Docker/docker/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/" title="分类于 教程">教程</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/theme-shoka-doc/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/computer-science/note/theme-shoka-doc/dependents/" title="Step.1 依赖插件">Step.1 依赖插件</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/markdown/" title="Markdown Style test">Markdown Style test</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/" title="分类于 教程">教程</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/theme-shoka-doc/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/computer-science/note/theme-shoka-doc/config/" title="Step.2 基本配置">Step.2 基本配置</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/container/" title="分类于 容器">容器</a>
</div>

    <span><a href="/computer-science/container/DockerCompose%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/dockercompose/" title="dockercompose笔记">dockercompose笔记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/container/" title="分类于 容器">容器</a>
</div>

    <span><a href="/computer-science/container/DockerDesktop%E5%85%A5%E9%97%A8%E7%AE%80%E4%BB%8B/dockerdesktop/" title="dockercompose笔记">dockercompose笔记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/" title="分类于 教程">教程</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/theme-shoka-doc/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/computer-science/note/theme-shoka-doc/display/" title="Step.3 界面显示">Step.3 界面显示</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/code-highlight/" title="Code Highlight Style test">Code Highlight Style test</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/container/" title="分类于 容器">容器</a>
</div>

    <span><a href="/computer-science/container/Docker/docker/" title="docker笔记">docker笔记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/" title="分类于 教程">教程</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/theme-shoka-doc/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/computer-science/note/theme-shoka-doc/special/" title="Step.4 主题特殊功能">Step.4 主题特殊功能</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/computer-science/" title="分类于 计算机">计算机</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/" title="分类于 教程">教程</a>
<i class="ic i-angle-right"></i>
<a href="/categories/computer-science/note/theme-shoka-doc/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/computer-science/note/theme-shoka-doc/" title="Hexo主题Shoka &amp; multi-markdown-it渲染器使用说明">Hexo主题Shoka & multi-markdown-it渲染器使用说明</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2022</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">hahayixiao @ HaHaYiXiao</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'computer-science/container/DockerCompose入门学习/dockercompose/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="//cdn.jsdelivr.net/gh/hahayixiao2/hahayixiao2.github.io/js/app.js?v=0.2.5"></script>




</body>
</html>
